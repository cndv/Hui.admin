/*!
 * ---------------------------
 * jQuery Library  timerHandler
 * jQuery 定时器插件
 * @version 1.0.2 01/30/2018
 * @author ygzhang.cn@msn.com
 * @link https://github.com/ygzhang-cn/timerHandler
 * @copyright 2015-2018 Kunming Dongring Technology Co., Ltd.
 * ---------------------------
 **/
 !function(t,i){"function"==typeof define&&define.amd?define(["jquery"],i):"object"==typeof exports?module.exports=i(require("jquery")):t.timerHandler=i(t.jQuery)}(this,function(t){"use strict";var i=window||this.window||!1,n=!!window&&"body";if(t.isFunction(t.timerHandler))return t.timerHandler;var a=function(t){this._name=t,this._timer=null,this._interval=0,this._limit=0,this._counter=0,this._callback=!1,this._callbackStart=!1,this._callbackStartEnd=!1,this._callbackPause=!1,this._callbackPauseEnd=!1,this._callbackStop=!1,this._callbackStopEnd=!1,this._runing=0,this._bindDom=!1};a.prototype={time:function(i){if(void 0==i||null==i)throw new Error("timerHandler.time(`value`) must be a string or number");var n={s:1e3,ms:1,m:6e4,h:36e5},a=/^([0-9]+)\s*([smh]+)?$/.exec(t.trim(i.toString()));if(a&&a.length>1){var e=parseFloat(a[1]),r=n[a[2]]||1;this._interval=parseInt(e*r)}else this._interval=i;return this},limit:function(t){return"number"==typeof t?this._limit=parseInt(t):console.log("timerHandler.limit(`value`) must be a integer"),this},bindDom:function(a){if(void 0==a||null==a)throw new Error("timerHandler.bindDom(`selector`) must be a string");if(i){this._bindDom=a;var e=this;t(n).on("DOMNodeRemoved DOMNodeRemovedFromDocument",a,function(){e.stop()})}return this},call:function(i){return t.isFunction(i)?this._callback=i:console.log("timerHandler.callback(`value`) must be a function"),this},callStart:function(i){return t.isFunction(i)&&(this._callbackStart=i),this},callStartEnd:function(i){return t.isFunction(i)&&(this._callbackStartEnd=i),this},callPause:function(i){return t.isFunction(i)&&(this._callbackPause=i),this},callPauseEnd:function(i){return t.isFunction(i)&&(this._callbackPauseEnd=i),this},callStop:function(i){return t.isFunction(i)&&(this._callbackStop=i),this},callStopEnd:function(i){return t.isFunction(i)&&(this._callbackStopEnd=i),this},start:function(){if(null===this._timer){var t=this,i=function(){0==t._runing&&(this._callbackStart&&this._callbackStart(),t._runing=1,0==t._limit||t._counter<t._limit?(t._counter++,!1===t._callback.call(t,t._counter)&&t.stop()):t.stop(),t._runing=0,this._callbackStartEnd&&this._callbackStartEnd())};this._timer=window.setInterval(i,this._interval)}return this},pause:function(){return e.data[this._name]&&(this._callbackPause&&this._callbackPause(),window.clearInterval(this._timer),this._timer=null,this._runing=0,this._callbackPauseEnd&&this._callbackPauseEnd()),this},stop:function(){return!!e.data[this._name]&&(this._callbackStop&&this._callbackStop(),window.clearInterval(this._timer),this._bindDom&&i&&t(n).off("DOMNodeRemoved DOMNodeRemovedFromDocument",this._bindDom),delete e.data[this._name],this._callbackStopEnd&&this._callbackStopEnd(),!0)}};var e=function(i){var n;if("number"!=typeof i&&"string"!=typeof i||!(i.length>0))throw new Error("timerHandler(`name`) must be a string");return n=t.trim(i.toString()),e.data[n]||(e.data[n]=new a(n)),e.data[n]};return e.data={},i&&t(i).on("unload",function(){t.each(e.data,function(t,i){i.stop()})}),t.timerHandler=e,t.timerHandler});